<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=author content><meta name=description content="In a previous post (&amp;ldquo;Automating Canvas Discussion Board Grading and Feedback&amp;rdquo;), I recounted some of the ways I&amp;rsquo;ve been using the CanvasAPI python library from ucfopen to help with responding to discussion board posts from students each week. I have had a couple of times when running the script shown in that post where something goes slightly awry: perhaps I have mistyped one of the student or assignment ids and the script runs into an error while iterating through the dataframe that contains all of the data I want to upload."><meta name=keywords content=",json,python json library,python,jupyter,jupyter notebooks,Canvas LMS,Canvas Instructure,grading"><meta name=robots content="noodp"><meta name=theme-color content><link rel=canonical href=https://kspicer80.github.io/posts/2023-01-13-canvas-live-api-work/><title>Interacting with the Canvas Live API :: Digital Forays — Tracing Paths through the Digital Humanities</title><link href=https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/main.4e5c639214707eff609bb55fe49e183dee42258a73bc90e4cc7b0a84f900798a.css><link rel=stylesheet type=text/css href=/css/style.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color><link rel="shortcut icon" href=/favicon.ico><meta name=msapplication-TileColor content><meta itemprop=name content="Interacting with the Canvas Live API"><meta itemprop=description content="In a previous post (&ldquo;Automating Canvas Discussion Board Grading and Feedback&rdquo;), I recounted some of the ways I&rsquo;ve been using the CanvasAPI python library from ucfopen to help with responding to discussion board posts from students each week. I have had a couple of times when running the script shown in that post where something goes slightly awry: perhaps I have mistyped one of the student or assignment ids and the script runs into an error while iterating through the dataframe that contains all of the data I want to upload."><meta itemprop=datePublished content="2023-01-13T00:06:12+00:00"><meta itemprop=dateModified content="2022-01-25T09:24:00+00:00"><meta itemprop=wordCount content="1868"><meta itemprop=image content="https://kspicer80.github.io/"><meta itemprop=keywords content="json,python json library,python,jupyter,jupyter notebooks,Canvas LMS,Canvas Instructure,grading,"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://kspicer80.github.io/"><meta name=twitter:title content="Interacting with the Canvas Live API"><meta name=twitter:description content="In a previous post (&ldquo;Automating Canvas Discussion Board Grading and Feedback&rdquo;), I recounted some of the ways I&rsquo;ve been using the CanvasAPI python library from ucfopen to help with responding to discussion board posts from students each week. I have had a couple of times when running the script shown in that post where something goes slightly awry: perhaps I have mistyped one of the student or assignment ids and the script runs into an error while iterating through the dataframe that contains all of the data I want to upload."><meta property="og:title" content="Interacting with the Canvas Live API"><meta property="og:description" content="In a previous post (&ldquo;Automating Canvas Discussion Board Grading and Feedback&rdquo;), I recounted some of the ways I&rsquo;ve been using the CanvasAPI python library from ucfopen to help with responding to discussion board posts from students each week. I have had a couple of times when running the script shown in that post where something goes slightly awry: perhaps I have mistyped one of the student or assignment ids and the script runs into an error while iterating through the dataframe that contains all of the data I want to upload."><meta property="og:type" content="article"><meta property="og:url" content="https://kspicer80.github.io/posts/2023-01-13-canvas-live-api-work/"><meta property="og:image" content="https://kspicer80.github.io/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-13T00:06:12+00:00"><meta property="article:modified_time" content="2022-01-25T09:24:00+00:00"><meta property="og:site_name" content="Digital Forays"><meta property="article:published_time" content="2023-01-13 00:06:12 +0000 UTC"></head><body><div class=container><header class=header><span class=header__inner><a href=/ style=text-decoration:none><div class=logo><span class=logo__mark>></span>
<span class=logo__text>conda activate</span>
<span class=logo__cursor></span></div></a><span class=header__right><nav class=menu><ul class=menu__inner><li><a href=/posts>Blog</a></li></ul></nav><span class=menu-trigger><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/></svg></span></span></span></header><div class=content><main class=post><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>9 minutes</p></div><article><h1 class=post-title><a href=https://kspicer80.github.io/posts/2023-01-13-canvas-live-api-work/>Interacting with the Canvas Live API</a></h1><div class=post-content><p>In a previous post (<a href=https://kspicer80.github.io/posts/2022-07-15-automating-canvas-grading-and-feedback_22/>&ldquo;Automating Canvas Discussion Board Grading and Feedback&rdquo;</a>), I recounted some of the ways I&rsquo;ve been using the <a href=https://canvasapi.readthedocs.io/en/stable/>CanvasAPI python library</a> from <a href=https://github.com/ucfopen/canvasapi>ucfopen</a> to help with responding to discussion board posts from students each week. I have had a couple of times when running the script shown in that post where something goes slightly awry: perhaps I have mistyped one of the student or assignment ids and the script runs into an error while iterating through the dataframe that contains all of the data I want to upload. There&rsquo;s no error handling in that script, so if I go and correct the mistake in the data file and then rerun the script, it now ends up reposting all of the data in the rows that it runs through before running into the line of code containing the snag. I opened up an <a href=https://github.com/ucfopen/canvasapi/issues/581>&ldquo;issue&rdquo;</a> on ucfopen&rsquo;s <a href=https://github.com/ucfopen/canvasapi>github</a>, asking where I would go via the canvasapi library to determine if a particular submission has any comments already uploaded to it—this would be one way to handle the potential duplication of comments. I got a really nice response from IonMich (Ioannis Michaloliakos) for how to handle this. For some reason that I&rsquo;m not quite sure I can account for, this response pushed me to wonder if I couldn&rsquo;t myself figure out how to just interact with the Canvas Live API itself, rather than going through the python wrapper provided via canvasapi. (I have used the <a href=https://requests.readthedocs.io/en/latest/><code>requests</code> library</a> in python for other projects before, but I got to thinking if things might be easier to just utilize that library alone.) This launched me off to the <a href=https://canvas.instructure.com/doc/api/index.html>official documentation</a> for Instructure&rsquo;s API.</p><p>Following the path laid out by IonMich&rsquo;s response, I wandered over to the <a href=https://canvas.instructure.com/doc/api/submissions.html#method.submissions_api.bulk_update><code>Submissions</code> endpoint</a>, zeroing in on the <a href=https://canvas.instructure.com/doc/api/submissions.html#method.submissions_api.bulk_update>method</a> that will allow one to &ldquo;Grade or comment on multiple submissions.&rdquo; Having found the method that would seem to do what I want to do, the next step was getting the data I wanted to upload in the correct form and structure. As detailed in the earlier, previously mentioned, post, I am still keeping the data to be uploaded to Canvas in a <code>.json</code> file that has been slightly altered:</p><p><img src=/images/imgforblogposts/post_28/test_json_datafile.png alt=testing_json_file></p><p>Typical workflow will follow: library import, getting all the information we need to successfully query the API, etc.:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>URL <span style=color:#f92672>=</span> <span style=color:#75715e># Here we&#39;ll store the URL to the appropriate API endpoint: one can play around with the Canvas Live API [here](https://canvas.instructure.com/doc/api/live)—although one will need to alter this to utilize the base URL to one&#39;s own Canvas system—through the web ahead of time to test out whether you&#39;ve got the correct endpoint, that it&#39;s returning the data one expects, etc.)</span>
</span></span><span style=display:flex><span>API_KEY <span style=color:#f92672>=</span> XXXXX <span style=color:#75715e># Here&#39;s where you insert your own unique API key </span>
</span></span><span style=display:flex><span>course_number <span style=color:#f92672>=</span> XXXXXXX <span style=color:#75715e># This variable will the course_id number that has the assignments one wants to upload grades to/for </span>
</span></span></code></pre></div><p>So what we need to do first is to get our data from the <code>.json</code> file into a format that we can then appropriately pass to the &ldquo;Request Parameters&rdquo; of the API (<a href=https://canvas.instructure.com/doc/api/submissions.html#method.submissions_api.bulk_update>here</a> again is the documentation about what these parameters should look like).</p><p>Given that I have data that looks like the screenshot above, we need to do a little tiny bit of reworking here—although certainly not much, all things considered.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;responses_json_for_blog_post.json&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>  data <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span></code></pre></div><p>As seasoned veterans know, the <code>json.load</code> returns us a Python <a href=https://www.geeksforgeeks.org/json-load-in-python/>dictionary</a>—in our case it gives us a dictionary with a single key, <code>"grade_data"</code>. The value for that key is itself a list of dictionaries:</p><p><img src=/images/imgforblogposts/post_28/type_from_json_load_and_full_dict_image.png alt=json_object_type_and_full_dict></p><p>Now we just need to write a (very!) simple <code>for loop</code> that will let us extract out the necessary data to feed as parameters to the <code>POST</code> call:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>dict_for_upload <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(data[<span style=color:#e6db74>&#39;grade_data&#39;</span>])):
</span></span><span style=display:flex><span>    id <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;student_id&#39;</span>]
</span></span><span style=display:flex><span>    score <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;posted_grade&#39;</span>]
</span></span><span style=display:flex><span>    comment <span style=color:#f92672>=</span> data[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;text_comment&#39;</span>]
</span></span><span style=display:flex><span>    dict_for_upload[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;grade_data[</span><span style=color:#e6db74>{</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>][posted_grade]&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>score<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    dict_for_upload[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;grade_data[</span><span style=color:#e6db74>{</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>][text_comment]&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>comment<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>dict_for_upload
</span></span></code></pre></div><p>This results in something that looks like the following:</p><p><img src=/images/imgforblogposts/post_28/dict_for_upload.png alt=dict_for_upload_image></p><p>Of course, we&rsquo;re shooting for something that looks like this:</p><p><img src=/images/imgforblogposts/post_28/canvas_api_docs_screenshot.png alt=instructure_official_docs_screenshot></p><p>Looks good! Now all we need to do is get everything set up properly for the <a href=https://requests.readthedocs.io/en/latest/user/quickstart/#passing-parameters-in-urls>requests library</a>.</p><p>As with so much here in this whole &ldquo;computer science&rdquo; realm, one can often get exactly what they want in a single line of code:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>header_argument <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Authorization&#34;</span>: <span style=color:#e6db74>&#34;Bearer &#34;</span> <span style=color:#f92672>+</span> API_KEY}
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(URL, headers<span style=color:#f92672>=</span>header_argument, data<span style=color:#f92672>=</span>dict_for_upload)
</span></span></code></pre></div><p>Simple as that.</p><p>Of course, the big question here is which avenue to prefer taking here: going through the ucf canvasapi wrapper or just dealing directly with the Instructure API. Furthermore, there is still the issue of how might want to do deal with the concern that started this investigation off in the first place—namely, making sure no duplicate comments get uploaded if the script fails somewhere along the line in the whole upload process. Of course, writing a function with the plan to use it directly with the API (not through the wrapper) seems easy enough. When you query the Instructure API to look at the data that contains whether or not a comment on a submission has been entered, one gets a response that has a key, <code>submission_comments</code>, containing a list with a dictionary that has a sub-key, <code>comment</code>. It&rsquo;s easy to check the response, if it gives us an empty list, then there&rsquo;s no existing comment, otherwise it returns the actual comment already posted, along with other data, of course. Again, once we know where that information is, one can simply write some code to check it before uploading the comments—thus avoiding the possibility of duplicating comments. Something not all that sophisticated would seem to do the trick (one would just need to make sure they were hitting the right data—<code>submission_comment[0]['comment']</code> is the right spot to look and is what should be passed to the function below):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>check_if_comments_already_exist</span>(submission_comments_field):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> submission_comments_field <span style=color:#f92672>==</span> []:
</span></span><span style=display:flex><span>        updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>False</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>        updated <span style=color:#f92672>=</span> <span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span>    print(updated)
</span></span></code></pre></div><p>Then we just incorporate that into the for loop so we get no duplicate comments added to each submission. We also need to make sure that we query the correct API endpoint/address to get the information about the assignment—once again, the official Instructure API docs help out here:</p><p><img src=/images/imgforblogposts/post_28/get_request_that_returns_submission_comment_data.png alt=querying_correct_address></p><p>It strikes me as perhaps much easier to deal directly with the Instructure API rather than going through the wrapper. I suppose it&rsquo;s difficult to give some principled reason for preferring one over the other. I suppose one could invoke something like &ldquo;proximity&rdquo; and &ldquo;closeness&rdquo; in terms of an idea like &ldquo;mediation.&rdquo; Best to reduce the number of mediations in between where one is and where one wants to get to &mldr; something more to ponder and ruminate upon, to be sure.</p><p>(All code and sample testing data for this post is available in the following <a href=https://github.com/kspicer80/canvas_api_for_grading_and_commenting>repository</a>.)</p><h5 id=addendum-1-tuesday-17-january-2023>Addendum #1, Tuesday, 17 January 2023:</h5><p>After spending a couple of days working on writing some functions to handle all of this—included a big one that contains all of the sub-functions necessary to read in a datafile and then upload everything to the proper place, I found myself noticing an odd and peculiar little illusion in my thinking. I know that so much in data analytics and science is data wrangling, getting data into some kind of structured format that you can then do something with, obviously. One could say that the data coming from the Instructure API is incredibly well-structured. I think that&rsquo;s pretty much true. Thus, in working directly with the API, one doesn&rsquo;t need to do a ton of data wrangling, although you do have to do some, especially in terms of getting the data structured so that the API gets the data it&rsquo;s expected, i.e. like with the <code>grade_data['text_comment']</code> and <code>grade_data['posted_score']</code> dictionary keys, etc. But all in all, not much wrangling. Now, of course, when you use the ucfopen python wrapper, the data that&rsquo;s being utilized by the wrapper is just as structured as when you don&rsquo;t work through the wrapper. But for some reason, that feels not to be the case—and I really haven&rsquo;t the foggiest idea why.</p><p>Well, that&rsquo;s not totally true—I think I do have some idea of why &mldr; maybe a simple example will suffice. When you want to get a list of users in a Canvas course, you can do the following to get the information via the canvasapi (and here I&rsquo;m just following the example from the official documentation <a href=https://canvasapi.readthedocs.io/en/stable/examples.html>here</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>canvas <span style=color:#f92672>=</span> Canvas(API_URL, API_KEY)
</span></span><span style=display:flex><span>course <span style=color:#f92672>=</span> canvas<span style=color:#f92672>.</span>get_course(course_number)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>all_users <span style=color:#f92672>=</span> course<span style=color:#f92672>.</span>get_users()
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> user <span style=color:#f92672>in</span> all_users:
</span></span><span style=display:flex><span>  print(user)
</span></span></code></pre></div><p>What gets printed out is bare bones. You get a readout that looks something like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>student_01_first_name student_01_middle_name student_01_last_name (student_id)
</span></span><span style=display:flex><span>student_02_first_name student_02_middle_name student_02_last_name (student_id)
</span></span><span style=display:flex><span>student_03_first_name student_03_middle_name student_03_last_name (student_id)
</span></span></code></pre></div><p>Of course, when going directly to the API, there&rsquo;s a richness of information, comparatively speaking, that the wrapper doesn&rsquo;t provide &mldr; which I&rsquo;m sure is by design, for sure. If one wants to dig deeper, then more function calls are in order. Maybe this all isn&rsquo;t that sophisticated. If one can get to their destination while only moving through one hoop (rather, than, say, another path that requires two or three of four hoops), then it would seem pretty to simple that the shorter route is preferable. Don&rsquo;t get me wrong, I love the canvasapi library—it started me on many of journeys here on this Digital Forays blog, but I&rsquo;m seeing the usefulness of being able to take slightly more direct paths. It may not have anything at all to do—really—with the structured (or unstructured) nature of the data (as, in this case, the data is structured either way), bit perhaps more to do with how the data is being accessed &mldr; as I say, I&rsquo;ll have to continue stewing on this a bit more.</p><h5 id=addendum-2-wednesday-25-january-2023>Addendum #2, Wednesday, 25 January 2023:</h5><p>Here&rsquo;s a full script to handle the uploading of grades and comments utilizing data in two <code>.json</code> files where the data is housed &mldr;:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># Script to Upload Discussion Board Comments for Weekly Student Posts</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> json
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> requests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>API_KEY <span style=color:#f92672>=</span> <span style=color:#75715e># your Instructure Canvas API key goes here</span>
</span></span><span style=display:flex><span>header_argument <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#34;Authorization&#34;</span>: <span style=color:#e6db74>&#34;Bearer &#34;</span> <span style=color:#f92672>+</span> API_KEY}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>course_number_id <span style=color:#f92672>=</span> <span style=color:#75715e># Canvas course number here ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>section_d_assignment_number <span style=color:#f92672>=</span> <span style=color:#75715e>#assignment number if the course is split up into sections</span>
</span></span><span style=display:flex><span>section_e_assignment_number <span style=color:#f92672>=</span> <span style=color:#75715e># same as above—you can add as many variables here as required by your own use case ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>create_dictionary_for_upload</span>(json_data_file):
</span></span><span style=display:flex><span>    dict_for_upload <span style=color:#f92672>=</span> {}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(json_data_file[<span style=color:#e6db74>&#39;grade_data&#39;</span>])):
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> json_data_file[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;student_id&#39;</span>]
</span></span><span style=display:flex><span>        score <span style=color:#f92672>=</span> json_data_file[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;posted_grade&#39;</span>]
</span></span><span style=display:flex><span>        comment <span style=color:#f92672>=</span> json_data_file[<span style=color:#e6db74>&#39;grade_data&#39;</span>][i][<span style=color:#e6db74>&#39;text_comment&#39;</span>]
</span></span><span style=display:flex><span>        dict_for_upload[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;grade_data[</span><span style=color:#e6db74>{</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>][posted_grade]&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>score<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>        dict_for_upload[<span style=color:#e6db74>f</span><span style=color:#e6db74>&#39;grade_data[</span><span style=color:#e6db74>{</span>id<span style=color:#e6db74>}</span><span style=color:#e6db74>][text_comment]&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>comment<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> dict_for_upload
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>load_json_datafile</span>(file_path):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>with</span> open(file_path, <span style=color:#e6db74>&#39;r&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>        section_datafile <span style=color:#f92672>=</span> json<span style=color:#f92672>.</span>load(f)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> section_datafile
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># The following function will get rid of all dictionaries for students who haven&#39;t anything to grade ...</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>remove_specific_keys_if_empty</span>(my_dict):
</span></span><span style=display:flex><span>    my_dict <span style=color:#f92672>=</span> {key: value <span style=color:#66d9ef>for</span> key, value <span style=color:#f92672>in</span> my_dict<span style=color:#f92672>.</span>items() <span style=color:#66d9ef>if</span> key <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> (<span style=color:#e6db74>&#39;posted_grade&#39;</span>,<span style=color:#e6db74>&#39;text_comment&#39;</span>) <span style=color:#f92672>or</span> value <span style=color:#f92672>!=</span> <span style=color:#e6db74>&#39;&#39;</span>}
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> my_dict
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>post_the_data</span>(data_dict_to_upload, course_number_id, section_assignment_number):
</span></span><span style=display:flex><span>    section_response <span style=color:#f92672>=</span> requests<span style=color:#f92672>.</span>post(
</span></span><span style=display:flex><span>      <span style=color:#75715e># API address goes here, </span>
</span></span><span style=display:flex><span>      headers<span style=color:#f92672>=</span>header_argument, data<span style=color:#f92672>=</span>data_dict_to_upload)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>process_and_upload</span>(filepath, course_id_number, section_assignment_number):
</span></span><span style=display:flex><span>    json_data <span style=color:#f92672>=</span> load_json_datafile(filepath)
</span></span><span style=display:flex><span>    initial_dict <span style=color:#f92672>=</span> create_dictionary_for_upload(json_data)
</span></span><span style=display:flex><span>    dict_for_upload <span style=color:#f92672>=</span> remove_specific_keys_if_empty(initial_dict)
</span></span><span style=display:flex><span>    post_the_data(dict_for_upload, course_id_number, section_assignment_number)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>section_d_filepath <span style=color:#f92672>=</span> <span style=color:#75715e># filepath for the .json file with the data to upload</span>
</span></span><span style=display:flex><span>section_e_filepath <span style=color:#f92672>=</span> <span style=color:#75715e># same as above ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>process_and_upload(section_d_filepath, course_number_id, section_d_assignment_number)
</span></span><span style=display:flex><span>process_and_upload(section_e_filepath, course_number_id, section_e_assignment_number)
</span></span></code></pre></div><p>There it is &mldr; all nice and clean and tidy—and in a very, very small number of lines of code &mldr;</p></div></article><hr><div class=post-info><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://kspicer80.github.io/tags/json/>json</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/python-json-library/>python json library</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/python/>python</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/jupyter/>jupyter</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/jupyter-notebooks/>jupyter notebooks</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/canvas-lms/>Canvas LMS</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/canvas-instructure/>Canvas Instructure</a></span>
<span class=tag><a href=https://kspicer80.github.io/tags/grading/>grading</a></span></p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6A2 2 0 004 4v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>1868 Words</p><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>2023-01-13 00:06
(Last updated: 2022-01-25 09:24)</p></div><hr><div class=sharing-buttons><a class=resp-sharing-button__link href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on facebook"><div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 2h-3a5 5 0 00-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 011-1h3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on twitter"><div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9.0 01-3.14 1.53 4.48 4.48.0 00-7.86 3v1A10.66 10.66.0 013 4s-4 9 5 13a11.64 11.64.0 01-7 2c9 5 20 0 20-11.5a4.5 4.5.0 00-.08-.83A7.72 7.72.0 0023 3z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.tumblr.com/widgets/share/tool?posttype=link&title=Interacting%20with%20the%20Canvas%20Live%20API&caption=Interacting%20with%20the%20Canvas%20Live%20API&canonicalUrl=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on tumblr"><div class="resp-sharing-button resp-sharing-button--tumblr resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.563 24c-5.093.0-7.031-3.756-7.031-6.411V9.747H5.116V6.648c3.63-1.313 4.512-4.596 4.71-6.469C9.84.051 9.941.0 9.999.0h3.517v6.114h4.801v3.633h-4.82v7.47c.016 1.001.375 2.371 2.207 2.371h.09c.631-.02 1.486-.205 1.936-.419l1.156 3.425c-.436.636-2.4 1.374-4.156 1.404h-.178l.011.002z"/></svg></div></div></a><a class=resp-sharing-button__link href="mailto:?subject=Interacting%20with%20the%20Canvas%20Live%20API&body=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_self rel=noopener aria-label title="Share via email"><div class="resp-sharing-button resp-sharing-button--email resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></div></div></a><a class=resp-sharing-button__link href="https://pinterest.com/pin/create/button/?url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f&media=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f;description=Interacting%20with%20the%20Canvas%20Live%20API" target=_blank rel=noopener aria-label title="Share on pinterest"><div class="resp-sharing-button resp-sharing-button--pinterest resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026L12.017.0z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f&title=Interacting%20with%20the%20Canvas%20Live%20API&summary=Interacting%20with%20the%20Canvas%20Live%20API&source=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on linkedin"><div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 8a6 6 0 016 6v7h-4v-7a2 2 0 00-2-2 2 2 0 00-2 2v7h-4v-7a6 6 0 016-6z"/><rect x="2" y="9" width="4" height="12"/><circle cx="4" cy="4" r="2"/></svg></div></div></a><a class=resp-sharing-button__link href="https://reddit.com/submit/?url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f&resubmit=true&title=Interacting%20with%20the%20Canvas%20Live%20API" target=_blank rel=noopener aria-label title="Share on reddit"><div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M12 0A12 12 0 000 12a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0012 0zm5.01 4.744c.688.0 1.25.561 1.25 1.249a1.25 1.25.0 01-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968.0 1.754.786 1.754 1.754.0.716-.435 1.333-1.01 1.614a3.111 3.111.0 01.042.52c0 2.694-3.13 4.87-7.004 4.87s-7.004-2.176-7.004-4.87c0-.183.015-.366.043-.534A1.748 1.748.0 014.028 12c0-.968.786-1.754 1.754-1.754.463.0.898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342.0 01.14-.197.35.35.0 01.238-.042l2.906.617a1.214 1.214.0 011.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687.0 1.248-.561 1.248-1.249S9.937 12 9.249 12zm5.5.0c-.687.0-1.248.561-1.248 1.25.0.687.561 1.248 1.249 1.248S16 13.937 16 13.249c0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327.0 00-.231.094.33.33.0 000 .463c.842.842 2.484.913 2.961.913s2.105-.056 2.961-.913a.361.361.0 00.029-.463.33.33.0 00-.464.0c-.547.533-1.684.73-2.512.73-.828.0-1.979-.196-2.512-.73a.326.326.0 00-.232-.095z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://www.xing.com/app/user?op=share;url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f;title=Interacting%20with%20the%20Canvas%20Live%20API" target=_blank rel=noopener aria-label title="Share on xing"><div class="resp-sharing-button resp-sharing-button--xing resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M18.188.0c-.517.0-.741.325-.927.66.0.0-7.455 13.224-7.702 13.657.015.024 4.919 9.023 4.919 9.023.17.308.436.66.967.66h3.454c.211.0.375-.078.463-.22.089-.151.089-.346-.009-.536l-4.879-8.916c-.004-.006-.004-.016.0-.022L22.139.756c.095-.191.097-.387.006-.535C22.056.078 21.894.0 21.686.0h-3.498zM3.648 4.74c-.211.0-.385.074-.473.216-.09.149-.078.339.02.531l2.34 4.05c.004.01.004.016.0.021L1.86 16.051c-.099.188-.093.381.0.529.085.142.239.234.45.234h3.461c.518.0.766-.348.945-.667l3.734-6.609-2.378-4.155c-.172-.315-.434-.659-.962-.659H3.648v.016z"/></svg></div></div></a><a class=resp-sharing-button__link href="whatsapp://send?text=Interacting%20with%20the%20Canvas%20Live%20API%20https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on whatsapp"><div class="resp-sharing-button resp-sharing-button--whatsapp resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198.0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479.0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87.0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86.0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64.0 5.122 1.03 6.988 2.898a9.825 9.825.0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815.0 0012.05.0C5.495.0.16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882.0 005.683 1.448h.005c6.554.0 11.89-5.335 11.893-11.893a11.821 11.821.0 00-3.48-8.413z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f&t=Interacting%20with%20the%20Canvas%20Live%20API" target=_blank rel=noopener aria-label title="Share on hacker news"><div class="resp-sharing-button resp-sharing-button--hackernews resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentcolor" stroke="none"><path d="M0 24V0h24v24H0zM6.951 5.896l4.112 7.708v5.064h1.583v-4.972l4.148-7.799h-1.749l-2.457 4.875c-.372.745-.688 1.434-.688 1.434s-.297-.708-.651-1.434L8.831 5.896h-1.88z"/></svg></div></div></a><a class=resp-sharing-button__link href="https://telegram.me/share/url?text=Interacting%20with%20the%20Canvas%20Live%20API&url=https%3a%2f%2fkspicer80.github.io%2fposts%2f2023-01-13-canvas-live-api-work%2f" target=_blank rel=noopener aria-label title="Share on telegram"><div class="resp-sharing-button resp-sharing-button--telegram resp-sharing-button--small"><div aria-hidden=true class="resp-sharing-button__icon resp-sharing-button__icon--solid"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg></div></div></a></div><div class=pagination><div class=pagination__title><span class=pagination__title-h>Read other posts</span><hr></div><div class=pagination__buttons><span class="button previous"><a href=https://kspicer80.github.io/posts/2023-04-07-fitzgerald-hemingway/><span class=button__icon>←</span>
<span class=button__text>Fitzgerald ... Hemingway ... Steinbeck</span></a></span>
<span class="button next"><a href=https://kspicer80.github.io/posts/2023-02-05-network-visualization-with-bokeh/><span class=button__text>Network Graph Visualization with Bokeh (Testing)</span>
<span class=button__icon>→</span></a></span></div></div></main></div><footer class=footer><div class=footer__inner><div class=footer__content><span><a href=https://github.com/kspicer80><i class="fa-brands fa-square-github"></i></a></span><span><a href=https://www.linkedin.com/in/kevin-spicer-61087037><i class="fa-brands fa-linkedin"></i></a></span></div></div></footer></div><script type=text/javascript src=/bundle.min.bb2c6bc3ed452ca4759660e4020811f248bc2320081559e8a32d8b0092773852941133639d35e8370d03d3ddaa750b1edd6b343c5bd22a55d5bdeae8f648f49b.js integrity="sha512-uyxrw+1FLKR1lmDkAggR8ki8IyAIFVnooy2LAJJ3OFKUETNjnTXoNw0D092qdQse3Ws0PFvSKlXVvero9kj0mw=="></script></body></html>